version: '3.8'

services:
  devcontainer:
    build:
      context: .
      dockerfile: Dockerfile
    
    volumes:
      # 프로젝트 디렉토리 마운트
      - ../:/workspace:cached
      
      # Docker socket 마운트 (Docker-in-Docker)
      - /var/run/docker.sock:/var/run/docker.sock
      
      # Git 설정 유지
      - ~/.gitconfig:/home/node/.gitconfig:ro
      
      # pnpm 캐시
      - pnpm-store:/home/node/.local/share/pnpm/store
    
    # 컨테이너를 계속 실행
    command: sleep infinity
    
    # 네트워크 설정
    network_mode: host
    
    # 환경 변수
    environment:
      - NODE_ENV=development
    
    # 특권 모드 (Docker-in-Docker를 위해)
    privileged: true

volumes:
  pnpm-store:


